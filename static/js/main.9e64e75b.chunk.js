(this["webpackJsonpthgttg-react"]=this["webpackJsonpthgttg-react"]||[]).push([[0],{219:function(t,e,n){},359:function(t,e,n){"use strict";n.r(e);var a=n(0),c=n.n(a),r=n(36),s=n.n(r),i=(n(219),n(45)),o=n(40),l=n(25),u=n(32),d=n.n(u),h=n(209),j=n(19),m=n.n(j),f=n(79),b=n(184),O=n(74),x=n(208),y=n(142),p=n(110),g=n(140),w=n(141),v=n(369),N=n(368),k=n(199),S=n(202),C=n(365),P=n(366),B=n(205),I=n(206),F=n(88),M=n(85),z=n(210),D=n(59),$=n(181),A=n(182),G=n(112),U=G.c.initializeDefaultAppClient("grenade-tnats"),q=U.getServiceClient(G.b.factory,"mongodb-atlas-grenade-stitch"),E=function(t,e){return m()(t.date)<m()(e.date)?-1:m()(t.date)>m()(e.date)?1:0},L={algo:{monetary:{unit:"algo"},fractional:{unit:"unknown",decimalPlaces:-1}},band:{monetary:{unit:"band"},fractional:{unit:"unknown",decimalPlaces:-1}},bch:{monetary:{unit:"bch"},fractional:{unit:"satoshi",decimalPlaces:8}},btc:{monetary:{unit:"btc"},fractional:{unit:"satoshi",decimalPlaces:8}},celo:{monetary:{unit:"celo"},fractional:{unit:"unknown",decimalPlaces:-1}},comp:{monetary:{unit:"comp"},fractional:{unit:"unknown",decimalPlaces:-1}},dash:{monetary:{unit:"dash"},fractional:{unit:"duff",decimalPlaces:8}},dot:{monetary:{unit:"dot"},fractional:{unit:"planck",decimalPlaces:10}},eth:{monetary:{unit:"eth"},fractional:{unit:"wei",decimalPlaces:18}},grt:{monetary:{unit:"grt"},fractional:{unit:"unknown",decimalPlaces:-1}},ksm:{monetary:{unit:"ksm"},fractional:{unit:"planck",decimalPlaces:12}},ltc:{monetary:{unit:"ltc"},fractional:{unit:"litoshi",decimalPlaces:8}},mkr:{monetary:{unit:"mkr"},fractional:{unit:"unknown",decimalPlaces:-1}},nu:{monetary:{unit:"nu"},fractional:{unit:"unknown",decimalPlaces:-1}},xlm:{monetary:{unit:"xlm"},fractional:{unit:"stroop",decimalPlaces:7}},xrp:{monetary:{unit:"xrp"},fractional:{unit:"drop",decimalPlaces:6}},zec:{monetary:{unit:"zec"},fractional:{unit:"zatoshi",decimalPlaces:8}}},R=function(){function t(e,n){var a=this;Object($.a)(this,t),this.quotes=n,this.currencies=Object(D.a)(new Set(this.quotes.map((function(t){return t.fiat})))).sort(),this.transactions=e.sort(E),this.earliestDate=m()(this.transactions[0].date).utcOffset(0).startOf("day").toISOString().slice(0,10),this.latestDate=m()().utcOffset(0).endOf("day").toISOString(),console.log("earliest: ".concat(this.earliestDate,", latest: ").concat(this.latestDate)),this.assets=Object(D.a)(new Set(this.transactions.map((function(t){return t.asset})))).sort(),this.balanceAtDate=function(t,e){return a.transactions.filter((function(n){return n.asset===t&&m()(n.date).utcOffset(0)<=e})).reduce((function(t,e){return t.plus(new d.a(e.amount))}),new d.a(0))},this.balances=Array.from({length:m()(this.latestDate).startOf("day").diff(m()(this.earliestDate).startOf("day"),"days")+1},(function(t,e){return m()(a.earliestDate).startOf("day").add(e,"days").toISOString().slice(0,10)})).map((function(t){return Object(o.a)(Object(o.a)({},Object.fromEntries(a.assets.map((function(e){var c=a.balanceAtDate(e,m()(t).utcOffset(0).endOf("day"));return[e,Object(o.a)(Object(o.a)({},Object.fromEntries(n.filter((function(n){return n.coin===e&&n.date===t})).map((function(t){return[t.fiat,c.times(d()(t.open.amount).plus(d()(t.close.amount)).dividedBy(d()(2))).decimalPlaces(2).toNumber()||d()(0).toNumber()]})))),{},Object(i.a)({},e,c.toNumber()))]})))),{},{date:t})}));var c=Object(D.a)(this.balances).pop();this.latestBalance=this.assets.filter((function(t){return!!c[t][a.currencies[0]]})).map((function(t){var e;return{name:t,value:(e={},Object(i.a)(e,t,c[t][t]),Object(i.a)(e,a.currencies[0],c[t][a.currencies[0]]),e)}}))}return Object(A.a)(t,null,[{key:"fromGist",value:function(e){return new Promise((function(n,a){fetch("https://api.github.com/gists/".concat(e)).then((function(t){return t.json()})).then((function(e){var a=Object.keys(e.files).filter((function(t){return t.endsWith(".json")})).map((function(t){return JSON.parse(e.files[t].content)})).reduce((function(t,e){return[].concat(Object(D.a)(t),Object(D.a)(e))})).filter((function(t){return Object.keys(L).includes(t.asset)})).sort(E),c=Object(D.a)(new Set(a.map((function(t){return t.asset})))),r=m()(a[0].date).utcOffset(0).startOf("day").toISOString().slice(0,10),s=m()().utcOffset(0).endOf("day").toISOString().slice(0,10);U.auth.loginWithCredential(new G.a).then((function(){q.db("grenade").collection("quote").find({$and:[{coin:{$in:c}},{date:{$gte:r}},{date:{$lte:s}}]}).asArray().then((function(e){n(new t(a,e))}))}))})).catch((function(t){a(t)}))}))}}]),t}(),Y=n(3),J=new h.a,K={bch:"#8dc351",btc:"#f7931a",dash:"#008ce7",dot:"#e71081",eth:"#444eec",ksm:"#8015ab",ltc:"#345d9d",xlm:"#14b6e7",xrp:"#23292f",zec:"#ecb244",default:"#cccccc"},V=function(t){var e=t.active,n=t.payload,a=t.label,c=t.currency;return e&&n?Object(Y.jsx)("div",{style:{backgroundColor:"#ffffff",padding:"1em",border:"1px solid #cccccc"},children:Object(Y.jsxs)("table",{style:{width:"100%"},children:[Object(Y.jsx)("thead",{children:Object(Y.jsx)("tr",{children:Object(Y.jsx)("th",{colSpan:"2",children:m()(a).format("MMMM Do, YYYY").toLowerCase()})})}),Object(Y.jsx)("tbody",{children:n.filter((function(t){return t.value>0})).map((function(t){return Object(Y.jsxs)("tr",{style:{color:K[t.name]||K.default},children:[Object(Y.jsx)("td",{children:t.name}),Object(Y.jsx)("td",{className:"text-right",children:Intl.NumberFormat("en-GB",{style:"currency",currency:c.toUpperCase()}).format(t.value)})]},t.name)}))}),Object(Y.jsx)("tfoot",{children:Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("td",{children:"total"}),Object(Y.jsx)("td",{className:"text-right",children:new Intl.NumberFormat("en-GB",{style:"currency",currency:c.toUpperCase()}).format(n.reduce((function(t,e){return t+(e.value||0)}),0))})]})})]})}):null},H=function(t){var e=t.cx,n=t.cy,a=t.midAngle,c=t.innerRadius,r=t.outerRadius,s=t.percent,i=(t.index,t.fill),o=t.asset,l=t.currency,u=Math.PI/180,d=c+1.5*(r-c),h=e+d*Math.cos(-a*u),j=n+d*Math.sin(-a*u),m=c+1.2*(r-c),f=e+m*Math.cos(-a*u),b=n+m*Math.sin(-a*u),O=c+.5*(r-c),x=e+O*Math.cos(-a*u),y=n+O*Math.sin(-a*u);return Object(Y.jsxs)(Y.Fragment,{children:[Object(Y.jsxs)("text",{x:h,y:j,fill:i,textAnchor:h>e?"start":"end",dominantBaseline:"central",children:[o.name," ",o.value[o.name]]}),Object(Y.jsxs)("text",{x:f,y:b,fill:i,textAnchor:f>e?"start":"end",dominantBaseline:"central",children:["(",new Intl.NumberFormat("en-GB",{style:"currency",currency:l.toUpperCase()}).format(o.value[l]),")"]}),Object(Y.jsx)("text",{x:x,y:y,fill:"white",textAnchor:x>e?"start":"end",dominantBaseline:"central",children:"".concat((100*s).toFixed(0),"%")})]})};function T(t,e,n,a,c){var r=c.find((function(t){return t.fiat===n&&t.coin===e&&t.date===a.slice(0,10)}));return r?d()(t).times(d()(r.open.amount).plus(d()(r.close.amount)).dividedBy(d()(2))).decimalPlaces(2).toNumber():(console.error("failed to find quote using args: amount: ".concat(t,", asset: ").concat(e,", currency: ").concat(n,", date: ").concat(a,", quotes.length,: ").concat(c.length)),0)}var W=function(){var t=Object(a.useState)({from:m()("2020-11-11").utcOffset(0).startOf("day"),to:m()().utcOffset(0).endOf("day")}),e=Object(l.a)(t,2),n=e[0],c=e[1],r=Object(a.useState)(J.get("currency")||"eur"),s=Object(l.a)(r,2),u=s[0],d=s[1],h=Object(a.useState)(window.location.href.match(/#[a-f0-9]{32}$/)?window.location.href.split("#").pop():J.get("gist")||"8272a8540d65584f16a2d3f6b9c34e4c"),j=Object(l.a)(h,2),D=j[0],$=j[1],A=Object(a.useState)(void 0),G=Object(l.a)(A,2),U=G[0],q=G[1];return Object(a.useEffect)((function(){u&&u.match(/^[a-z]{3}$/)&&J.get("currency")!==u&&J.set("currency",u,{path:"/"})}),[u]),Object(a.useEffect)((function(){D&&D.match(/^[a-f0-9]{32}$/)&&J.get("gist")!==D&&J.set("gist",D,{path:"/"})}),[D]),Object(a.useEffect)((function(){D&&D.match(/^[a-f0-9]{32}$/)&&R.fromGist(D).then(q).catch(console.error)}),[D]),Object(Y.jsxs)(b.a,{fluid:!0,children:[Object(Y.jsxs)(y.a,{bg:"dark",variant:"dark",children:[Object(Y.jsx)(y.a.Brand,{href:"#",children:"don\u2019t panic"}),Object(Y.jsx)(x.a,{className:"mr-auto"}),Object(Y.jsxs)(O.a,{inline:!0,children:[Object(Y.jsx)(O.a.Control,{type:"text",style:{width:"7em"},className:"mr-sm-2",size:"sm",disabled:!0,value:n.from,onChange:function(t){var e=t.target.value;e.match(/^20[12][0-9]-[01][0-9]-[0123][0-9]$/)&&c((function(t){return Object(o.a)(Object(o.a)({},t),{},{from:e})}))}}),Object(Y.jsx)(O.a.Control,{type:"text",style:{width:"7em"},className:"mr-sm-2",size:"sm",disabled:!0,defaultValue:m()(n.to).toISOString().slice(0,10),onChange:function(t){var e=t.target.value;e.match(/^20[12][0-9]-[01][0-9]-[0123][0-9]$/)&&c((function(t){return Object(o.a)(Object(o.a)({},t),{},{to:e})}))}}),Object(Y.jsx)(O.a.Control,{type:"text",placeholder:"gist id",style:{width:"19em"},className:"mr-sm-2",size:"sm",disabled:!0,defaultValue:D,onChange:function(t){var e=t.target.value;e.match(/^[a-f0-9]{32}$/)&&$(e)}}),Object(Y.jsxs)(O.a.Control,{as:"select",className:"mr-sm-2",size:"sm",disabled:!0,defaultValue:u,onChange:function(t){var e=t.target.value;e.match(/^[a-f]{3}$/)&&d(e)},children:[Object(Y.jsx)("option",{children:"eur"}),Object(Y.jsx)("option",{children:"usd"})]})]})]}),Object(Y.jsxs)(p.a,{children:[Object(Y.jsx)(f.a,{sm:4,children:U&&U.latestBalance.length?Object(Y.jsx)(v.a,{width:"100%",minHeight:"500px",children:Object(Y.jsx)(N.a,{children:Object(Y.jsx)(k.a,{data:U.latestBalance,cx:"50%",cy:"50%",label:H,outerRadius:80,dataKey:"value.".concat(u),children:U.latestBalance.map((function(t){var e;return Object(Y.jsx)(S.a,{fill:K[t.name],asset:{name:t.name,value:(e={},Object(i.a)(e,u,t.value[u]),Object(i.a)(e,t.name,t.value[t.name]),e)},currency:u},t.name)}))})})}):Object(Y.jsx)(g.a,{animation:"grow"})}),Object(Y.jsx)(f.a,{sm:8,children:U&&U.balances.length?Object(Y.jsx)(v.a,{width:"100%",minHeight:"500px",children:Object(Y.jsxs)(C.a,{data:U.balances.filter((function(t){return m()(t.date).isBetween(n.from,n.to)})),margin:{top:50,right:10,left:10,bottom:10},children:[Object(Y.jsx)(P.a,{strokeDasharray:"3 3"}),Object(Y.jsx)(B.a,{dataKey:"date",tick:{fontSize:11},tickFormatter:function(t){return m()(t).format("MMM D").toLowerCase()}}),Object(Y.jsx)(I.a,{tick:{fontSize:11},tickFormatter:function(t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:u.toUpperCase()}).format(t)}}),Object(Y.jsx)(F.a,{content:Object(Y.jsx)(V,{}),currency:u}),Object(Y.jsx)(M.a,{}),U.assets.map((function(t){return Object(Y.jsx)(z.a,{type:"monotone",name:"".concat(t),dataKey:"".concat(t,".").concat(u),dot:!1,stroke:K[t]||K.default},t)}))]})}):Object(Y.jsx)(g.a,{animation:"grow"})})]}),Object(Y.jsx)(p.a,{children:Object(Y.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,size:"sm",style:{margin:"50px 10px 10px 10px"},children:[Object(Y.jsxs)("thead",{children:[Object(Y.jsx)("tr",{children:Object(Y.jsx)("th",{colSpan:"4",className:"text-right",children:"transaction history"})}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{children:"date"}),Object(Y.jsx)("th",{children:"note"}),Object(Y.jsx)("th",{className:"text-right",children:"asset amount"}),Object(Y.jsxs)("th",{className:"text-right",children:[u," amount"]})]})]}),Object(Y.jsx)("tbody",{children:U&&U.transactions.length?U.transactions.filter((function(t){return m()(t.date).isBetween(n.from,n.to)})).map((function(t,e){return Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("td",{children:t.date}),Object(Y.jsx)("td",{children:t.note}),Object(Y.jsxs)("td",{className:"text-right",children:[t.asset," ",t.amount]}),Object(Y.jsx)("td",{className:"text-right",children:new Intl.NumberFormat("en-GB",{style:"currency",currency:u.toUpperCase()}).format(T(t.amount,t.asset,u,t.date,U.quotes))})]},e)})):null})]})}),Object(Y.jsx)(p.a,{children:U&&U.balances.length?Object(Y.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,size:"sm",style:{margin:"50px 10px 10px 10px"},children:[Object(Y.jsxs)("thead",{children:[Object(Y.jsx)("tr",{children:Object(Y.jsx)("th",{colSpan:U.assets.length+2,className:"text-right",children:"balance history"})}),Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{children:"date"}),U.assets.map((function(t){return Object(Y.jsx)("th",{className:"text-right",children:t},t)})),Object(Y.jsx)("th",{className:"text-right",children:"total"})]})]}),Object(Y.jsx)("tbody",{children:U.balances.filter((function(t){return m()(t.date).isBetween(n.from,n.to)})).map((function(t){return Object(Y.jsxs)("tr",{children:[Object(Y.jsx)("th",{children:t.date}),U.assets.map((function(e){return Object(Y.jsxs)("td",{className:"text-right",children:[Object(Y.jsx)("span",{className:"text-muted",style:{marginRight:"1em"},children:t[e][e]}),new Intl.NumberFormat("en-GB",{style:"currency",currency:u.toUpperCase()}).format(t[e][u]||0)]},"".concat(t.date,"-").concat(e))})),Object(Y.jsx)("td",{className:"text-right",children:new Intl.NumberFormat("en-GB",{style:"currency",currency:u.toUpperCase()}).format(U.assets.reduce((function(e,n){return e+(t[n][u]||0)}),0))})]},t.date)}))})]}):null})]})},Q=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,370)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),a(t),c(t),r(t),s(t)}))};n(358);s.a.render(Object(Y.jsx)(c.a.StrictMode,{children:Object(Y.jsx)(W,{})}),document.getElementById("root")),Q()}},[[359,1,2]]]);
//# sourceMappingURL=main.9e64e75b.chunk.js.map