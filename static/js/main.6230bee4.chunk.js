(this["webpackJsonpthgttg-react"]=this["webpackJsonpthgttg-react"]||[]).push([[0],{257:function(t,e,a){},472:function(t,e,a){"use strict";a.r(e);var n=a(0),c=a.n(n),r=a(39),s=a.n(r),o=(a(257),a(28)),i=a(25),l=a(33),u=a.n(l),d=a(247),j=a(17),h=a.n(j),m=a(77),b=a(221),f=a(84),O=a(222),x=a(246),y=a(166),p=a(82),g=a(96),w=a(128),v=a(217),B=a.n(v),k=a(482),N=a(481),S=a(237),C=a(240),F=a(478),I=a(479),P=a(243),M=a(244),D=a(99),z=a(95),A=a(248),E=a(117),G=a(51),$=a(218),U=a(219),Q=a(130),q=Q.c.initializeDefaultAppClient("grenade-tnats"),L=q.getServiceClient(Q.b.factory,"mongodb-atlas-grenade-stitch"),T=function(t,e){return h()(t.date)<h()(e.date)?-1:h()(t.date)>h()(e.date)?1:0},K={algo:{monetary:{unit:"algo"},fractional:{unit:"unknown",decimalPlaces:-1}},band:{monetary:{unit:"band"},fractional:{unit:"unknown",decimalPlaces:-1}},bch:{monetary:{unit:"bch"},fractional:{unit:"satoshi",decimalPlaces:8}},btc:{monetary:{unit:"btc"},fractional:{unit:"satoshi",decimalPlaces:8}},celo:{monetary:{unit:"celo"},fractional:{unit:"unknown",decimalPlaces:-1}},comp:{monetary:{unit:"comp"},fractional:{unit:"unknown",decimalPlaces:-1}},dash:{monetary:{unit:"dash"},fractional:{unit:"duff",decimalPlaces:8}},dot:{monetary:{unit:"dot"},fractional:{unit:"planck",decimalPlaces:10}},eth:{monetary:{unit:"eth"},fractional:{unit:"wei",decimalPlaces:18}},grt:{monetary:{unit:"grt"},fractional:{unit:"unknown",decimalPlaces:-1}},ksm:{monetary:{unit:"ksm"},fractional:{unit:"planck",decimalPlaces:12}},ltc:{monetary:{unit:"ltc"},fractional:{unit:"litoshi",decimalPlaces:8}},mkr:{monetary:{unit:"mkr"},fractional:{unit:"unknown",decimalPlaces:-1}},nu:{monetary:{unit:"nu"},fractional:{unit:"unknown",decimalPlaces:-1}},uma:{monetary:{unit:"uma"},fractional:{unit:"unknown",decimalPlaces:18}},xlm:{monetary:{unit:"xlm"},fractional:{unit:"stroop",decimalPlaces:7}},xrp:{monetary:{unit:"xrp"},fractional:{unit:"drop",decimalPlaces:6}},zec:{monetary:{unit:"zec"},fractional:{unit:"zatoshi",decimalPlaces:8}}},R=function(){function t(e,a){var n=this;Object($.a)(this,t);var c=Object(G.a)(new Set(e.map((function(t){return t.asset})))).sort(),r=Object(G.a)(new Set(a.map((function(t){return t.fiat})))).sort();this.assets=c,this.quotes=a.map((function(t){var e=a.find((function(e){return e.coin===t.coin&&e.fiat===t.fiat&&e.date===h.a.utc(t.date).startOf("day").subtract(1,"day").toISOString().slice(0,10)}));return Object(o.a)(Object(o.a)({},t),{},{change:e?u()(t.close.amount).minus(u()(e.close.amount)).dividedBy(u()(e.close.amount)).times(100):0})})),this.todaysQuotes=Object.fromEntries(c.map((function(t){return[t,Object.fromEntries(r.map((function(e){return[e,n.quotes.find((function(a){return a.coin===t&&a.fiat===e&&a.date===h.a.utc().startOf("day").toISOString().slice(0,10)}))]})))]}))),this.currencies=r,this.transactions=e.sort(T),this.earliestDate=h.a.utc(this.transactions[0].date).startOf("day").toISOString().slice(0,10),this.latestDate=h.a.utc().endOf("day").toISOString(),console.log("earliest: ".concat(this.earliestDate,", latest: ").concat(this.latestDate)),this.quoteAtDate=function(t,e,a){return n.quotes.find((function(n){return n.coin===t&&n.fiat===e&&n.date===a}))},this.balanceAtDate=function(t,e){return n.transactions.filter((function(a){return a.asset===t&&h.a.utc(a.date)<=e})).reduce((function(t,e){return t.plus(new u.a(e.amount))}),new u.a(0))},this.balances=Array.from({length:h()(this.latestDate).startOf("day").diff(h()(this.earliestDate).startOf("day"),"days")+1},(function(t,e){return h()(n.earliestDate).startOf("day").add(e,"days").toISOString().slice(0,10)})).map((function(t){return Object(o.a)(Object(o.a)({},Object.fromEntries(n.assets.map((function(e){var c=n.balanceAtDate(e,h.a.utc(t).endOf("day"));return[e,Object(o.a)(Object(o.a)({},Object.fromEntries(a.filter((function(a){return a.coin===e&&a.date===t})).map((function(t){return[t.fiat,c.times(u()(t.close.amount)).decimalPlaces(2).toNumber()||u()(0).toNumber()]})))),{},Object(E.a)({},e,c.toNumber()))]})))),{},{date:t})})).map((function(t){return Object(o.a)(Object(o.a)({},t),{},{total:Object.fromEntries(r.map((function(e){return[e,c.reduce((function(a,n){return a+(t[n][e]||0)}),0)]})))})}));var s=Object(G.a)(this.balances).pop(),i=Object(G.a)(this.balances).slice(-2,-1)[0];this.latestBalance=Object.fromEntries([].concat(Object(G.a)(c),["total"]).filter((function(t){return"total"===t||!!s[t][t]})).map((function(t){return[t,Object.fromEntries(r.map((function(e){return[e,{amount:"total"!==t?s[t][t]:0,value:s[t][e],change:{day:(s[t][e]-(i[t][e]||0))/(i[t][e]||0)*100}}]})))]})))}return Object(U.a)(t,null,[{key:"fromGist",value:function(e){return new Promise((function(a,n){fetch("https://api.github.com/gists/".concat(e)).then((function(t){return t.json()})).then((function(e){var n=Object.keys(e.files).filter((function(t){return t.endsWith(".json")})).map((function(t){return JSON.parse(e.files[t].content).map((function(e){return Object(o.a)(Object(o.a)({},e),{},{vault:t.slice(0,-5)})}))})).reduce((function(t,e){return[].concat(Object(G.a)(t),Object(G.a)(e))})).filter((function(t){return Object.keys(K).includes(t.asset)})).sort(T),c=Object(G.a)(new Set(n.map((function(t){return t.asset})))),r=h.a.utc(n[0].date).startOf("day").toISOString().slice(0,10),s=h.a.utc().endOf("day").toISOString().slice(0,10);q.auth.loginWithCredential(new Q.a).then((function(){L.db("grenade").collection("quote").find({$and:[{coin:{$in:c}},{date:{$gte:r}},{date:{$lte:s}}]}).asArray().then((function(e){a(new t(n,e))}))}))})).catch((function(t){n(t)}))}))}}]),t}(),Y=a(127),H=a(66),J=a(50),V=a(2);J.b.add(H.d,H.a),J.b.add(H.d,H.b),J.b.add(H.d,H.c);var W=new d.a,_={bch:"#8dc351",btc:"#f7931a",dash:"#008ce7",dot:"#e71081",eth:"#444eec",ksm:"#8015ab",ltc:"#345d9d",uma:"#fe4b49",xlm:"#14b6e7",xrp:"#23292f",zec:"#ecb244",total:"#999999",default:"#cccccc"},X=function(t){var e=t.active,a=t.payload,n=t.label,c=t.currency;return e&&a?Object(V.jsx)("div",{style:{backgroundColor:"#ffffff",padding:"1em",border:"1px solid #cccccc"},children:Object(V.jsxs)("table",{style:{width:"100%"},children:[Object(V.jsx)("thead",{children:Object(V.jsx)("tr",{children:Object(V.jsx)("th",{colSpan:"2",children:h()(n).format("MMMM Do, YYYY").toLowerCase()})})}),Object(V.jsx)("tbody",{children:a.filter((function(t){return"total"!==t.name&&t.value>0})).map((function(t){return Object(V.jsxs)("tr",{style:{color:_[t.name]||_.default},children:[Object(V.jsx)("td",{children:t.name}),Object(V.jsx)("td",{className:"text-right",children:Intl.NumberFormat("en-GB",{style:"currency",currency:c.toUpperCase()}).format(t.value)})]},t.name)}))}),Object(V.jsx)("tfoot",{children:Object(V.jsxs)("tr",{style:{color:_.total,borderBottom:"1px dashed ".concat(_.total),borderTop:"1px dashed ".concat(_.total)},children:[Object(V.jsx)("th",{children:"total"}),Object(V.jsx)("th",{className:"text-right",children:new Intl.NumberFormat("en-GB",{style:"currency",currency:c.toUpperCase()}).format(a.find((function(t){return"total"===t.name})).value)})]})})]})}):null},Z=function(t){var e=t.cx,a=t.cy,n=t.midAngle,c=t.innerRadius,r=t.outerRadius,s=t.percent,o=(t.index,t.fill),i=t.asset,l=t.currency,u=t.balance,d=Math.PI/180,j=c+2*(r-c),h=e+j*Math.cos(-n*d),m=a+j*Math.sin(-n*d),b=c+1.2*(r-c),f=e+b*Math.cos(-n*d),O=a+b*Math.sin(-n*d),x=c+.5*(r-c),y=e+x*Math.cos(-n*d),p=a+x*Math.sin(-n*d);return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("text",{x:h,y:m,fill:o,textAnchor:h>e?"start":"end",dominantBaseline:"central",children:[i," ",u.amount]}),Object(V.jsxs)("text",{x:f,y:O,fill:o,textAnchor:f>e?"start":"end",dominantBaseline:"central",children:["(",new Intl.NumberFormat("en-GB",{style:"currency",currency:l.toUpperCase()}).format(u.value),")"]}),Object(V.jsx)("text",{x:y,y:p,fill:"white",textAnchor:y>e?"start":"end",dominantBaseline:"central",children:"".concat((100*s).toFixed(0),"%")})]})};function tt(t,e,a,n,c){var r=c.find((function(t){return t.fiat===a&&t.coin===e&&t.date===n.slice(0,10)}));return r?u()(t).times(u()(r.open.amount).plus(u()(r.close.amount)).dividedBy(u()(2))).decimalPlaces(2).toNumber():(console.error("failed to find quote using args: amount: ".concat(t,", asset: ").concat(e,", currency: ").concat(a,", date: ").concat(n,", quotes.length,: ").concat(c.length)),0)}var et=function(){var t=Object(n.useState)(void 0),e=Object(i.a)(t,2),a=e[0],r=e[1],s=Object(n.useState)({from:h.a.utc("2020-11-11").startOf("day"),to:h.a.utc().endOf("day")}),l=Object(i.a)(s,2),u=l[0],d=l[1],j=Object(n.useState)(W.get("currency")||"eur"),v=Object(i.a)(j,2),E=v[0],G=v[1],$=Object(n.useState)(window.location.href.match(/#[a-f0-9]{32}$/)?window.location.href.split("#").pop():W.get("gist")||"8272a8540d65584f16a2d3f6b9c34e4c"),U=Object(i.a)($,2),Q=U[0],q=U[1],L=Object(n.useState)(void 0),T=Object(i.a)(L,2),K=T[0],H=T[1];return Object(n.useEffect)((function(){if(!a){var t="localhost"===window.location.hostname?"".concat(window.location.protocol,"//").concat(window.location.hostname,":").concat(window.location.port,"/footer.md"):"https://thgttg.com/footer.md";fetch(t).then((function(t){return t.text()})).then(r).catch(console.error)}}),[a]),Object(n.useEffect)((function(){E&&E.match(/^[a-z]{3}$/)&&W.get("currency")!==E&&W.set("currency",E,{path:"/"})}),[E]),Object(n.useEffect)((function(){Q&&Q.match(/^[a-f0-9]{32}$/)&&W.get("gist")!==Q&&W.set("gist",Q,{path:"/"})}),[Q]),Object(n.useEffect)((function(){Q&&Q.match(/^[a-f0-9]{32}$/)&&R.fromGist(Q).then(H).catch(console.error)}),[Q]),Object(V.jsxs)(b.a,{fluid:!0,children:[Object(V.jsxs)(y.a,{bg:"dark",variant:"dark",children:[Object(V.jsx)(y.a.Brand,{href:"#",children:"don\u2019t panic"}),Object(V.jsx)(x.a,{className:"mr-auto"}),Object(V.jsxs)(f.a,{inline:!0,children:[Object(V.jsx)(f.a.Control,{type:"text",style:{width:"7em"},className:"mr-sm-2",size:"sm",disabled:!0,value:h.a.utc(u.from).toISOString().slice(0,10),onChange:function(t){var e=t.target.value;e.match(/^20[12][0-9]-[01][0-9]-[0123][0-9]$/)&&d((function(t){return Object(o.a)(Object(o.a)({},t),{},{from:h.a.utc(e).startOf("day")})}))}}),Object(V.jsx)(f.a.Control,{type:"text",style:{width:"7em"},className:"mr-sm-2",size:"sm",disabled:!0,defaultValue:h.a.utc(u.to).toISOString().slice(0,10),onChange:function(t){var e=t.target.value;e.match(/^20[12][0-9]-[01][0-9]-[0123][0-9]$/)&&d((function(t){return Object(o.a)(Object(o.a)({},t),{},{to:h.a.utc(e).endOf("day")})}))}}),Object(V.jsx)(f.a.Control,{type:"text",placeholder:"gist id",style:{width:"19em"},className:"mr-sm-2",size:"sm",disabled:!0,defaultValue:Q,onChange:function(t){var e=t.target.value;e.match(/^[a-f0-9]{32}$/)&&q(e)}}),Object(V.jsxs)(f.a.Control,{as:"select",className:"mr-sm-2",size:"sm",defaultValue:E,onChange:function(t){var e=t.target.value;e.match(/^[a-z]{3}$/)&&G(e)},children:[Object(V.jsx)("option",{children:"eur"}),Object(V.jsx)("option",{children:"gbp"}),Object(V.jsx)("option",{children:"usd"})]})]})]}),Object(V.jsx)(p.a,{children:K&&K.latestBalance?Object(V.jsxs)(w.a,{hover:!0,size:"sm",style:{margin:"50px 10px 10px 10px"},children:[Object(V.jsx)("thead",{children:Object(V.jsxs)("tr",{children:[Object(V.jsxs)("th",{style:{color:_.total},children:[new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(K.latestBalance.total[E].value),Object(V.jsxs)("span",{style:{marginLeft:"1em",color:K.latestBalance.total[E].change.day>0?"green":K.latestBalance.total[E].change.day<0?"red":"black"},children:[Object(V.jsx)(Y.a,{icon:["fas",K.latestBalance.total[E].change.day>0?"caret-up":K.latestBalance.total[E].change.day<0?"caret-down":"circle"]}),K.latestBalance.total[E].change.day.toFixed(2),"%"]})]}),Object.keys(K.latestBalance).filter((function(t){return"total"!==t})).map((function(t){return Object(V.jsxs)(c.a.Fragment,{children:[Object(V.jsx)("th",{className:"text-right",children:Object(V.jsx)(O.a,{src:"".concat(t,".png"),alt:"".concat(t," logo"),style:{height:"20px",width:"20px"},roundedCircle:!0})}),Object(V.jsx)("th",{className:"text-left",style:{color:_[t]},children:t})]},t)}))]})}),Object(V.jsxs)("tbody",{children:[Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"portfolio value"}),Object.keys(K.latestBalance).filter((function(t){return"total"!==t})).map((function(t){return Object(V.jsxs)(c.a.Fragment,{children:[Object(V.jsx)("td",{className:"text-right",style:{color:_[t]},children:new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(K.latestBalance[t][E].value)}),Object(V.jsxs)("td",{style:{color:K.latestBalance[t][E].change.day>0?"green":K.latestBalance[t][E].change.day<0?"red":"black"},children:[Object(V.jsx)(Y.a,{icon:["fas",K.latestBalance[t][E].change.day>0?"caret-up":K.latestBalance[t][E].change.day<0?"caret-down":"circle"]}),K.latestBalance[t][E].change.day.toFixed(2),"%"]})]},t)}))]}),Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"market price"}),Object.keys(K.latestBalance).filter((function(t){return"total"!==t})).map((function(t){return Object(V.jsxs)(c.a.Fragment,{children:[Object(V.jsx)("td",{className:"text-right",style:{color:_[t],width:"".concat(100/Object.keys(K.latestBalance).length/2,"%")},children:new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(K.todaysQuotes[t][E].close.amount)}),Object(V.jsxs)("td",{style:{width:"".concat(100/Object.keys(K.latestBalance).length/2,"%"),color:K.todaysQuotes[t][E].change>0?"green":K.todaysQuotes[t][E].change<0?"red":"black"},children:[Object(V.jsx)(Y.a,{icon:["fas",K.todaysQuotes[t][E].change>0?"caret-up":K.todaysQuotes[t][E].change<0?"caret-down":"circle"]}),K.todaysQuotes[t][E].change.toFixed(2),"%"]})]},t)}))]})]}),Object(V.jsx)("tfoot",{children:Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"price observation"}),Object.keys(K.latestBalance).filter((function(t){return"total"!==t})).map((function(t){return Object(V.jsx)(c.a.Fragment,{children:Object(V.jsxs)("td",{colSpan:"2",className:"text-center",style:{color:_[t]},children:[h.a.utc(K.todaysQuotes[t][E].close.time).format("MMMM Do").toLowerCase()," - ",h.a.utc(K.todaysQuotes[t][E].close.time).format(h.a.HTML5_FMT.TIME_SECONDS)," utc"]})},t)}))]})})]}):Object(V.jsx)(g.a,{animation:"grow"})}),Object(V.jsxs)(p.a,{children:[Object(V.jsx)(m.a,{sm:4,children:K&&K.latestBalance?Object(V.jsx)(k.a,{width:"100%",minHeight:"500px",children:Object(V.jsx)(N.a,{children:Object(V.jsx)(S.a,{data:Object.keys(K.latestBalance).filter((function(t){return"total"!==t})).map((function(t){return K.latestBalance[t][E]})),cx:"50%",cy:"50%",label:Z,outerRadius:80,dataKey:"value",children:Object.keys(K.latestBalance).map((function(t){return Object(V.jsx)(C.a,{fill:_[t],asset:t,currency:E,balance:K.latestBalance[t][E]},t)}))})})}):Object(V.jsx)(g.a,{animation:"grow"})}),Object(V.jsx)(m.a,{sm:8,children:K&&K.balances.length?Object(V.jsx)(k.a,{width:"100%",minHeight:"500px",children:Object(V.jsxs)(F.a,{data:K.balances.filter((function(t){return h()(t.date).isBetween(u.from,u.to)})),margin:{top:50,right:10,left:10,bottom:10},children:[Object(V.jsx)(I.a,{strokeDasharray:"3 3"}),Object(V.jsx)(P.a,{dataKey:"date",tick:{fontSize:11},tickFormatter:function(t){return h()(t).format("MMM D").toLowerCase()}}),Object(V.jsx)(M.a,{yAxisId:"left",tick:{fontSize:11},tickFormatter:function(t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(t)}}),Object(V.jsx)(M.a,{yAxisId:"right",orientation:"right",strokeDasharray:"5 5",tick:{fontSize:11},tickFormatter:function(t){return new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(t)}}),Object(V.jsx)(D.a,{content:Object(V.jsx)(X,{}),currency:E}),Object(V.jsx)(z.a,{}),K.assets.map((function(t){return Object(V.jsx)(A.a,{yAxisId:"left",type:"monotone",name:"".concat(t),dataKey:"".concat(t,".").concat(E),dot:!1,stroke:_[t]||_.default},t)})),Object(V.jsx)(A.a,{yAxisId:"right",type:"monotone",name:"total",dataKey:"total.".concat(E),strokeDasharray:"5 5",dot:!1,stroke:_.total})]})}):Object(V.jsx)(g.a,{animation:"grow"})})]}),Object(V.jsx)(p.a,{children:Object(V.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,size:"sm",style:{margin:"50px 10px 10px 10px"},children:[Object(V.jsxs)("thead",{children:[Object(V.jsx)("tr",{children:Object(V.jsx)("th",{colSpan:"5",className:"text-right",children:"transaction history"})}),Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"date"}),Object(V.jsx)("th",{children:"vault"}),Object(V.jsx)("th",{children:"note"}),Object(V.jsx)("th",{className:"text-right",children:"asset amount"}),Object(V.jsxs)("th",{className:"text-right",children:[E," amount"]})]})]}),Object(V.jsx)("tbody",{children:K&&K.transactions.length?K.transactions.filter((function(t){return h()(t.date).isBetween(u.from,u.to)})).map((function(t,e){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("td",{children:t.date}),Object(V.jsx)("td",{children:t.vault}),Object(V.jsx)("td",{children:t.note}),Object(V.jsxs)("td",{className:"text-right",style:{color:_[t.asset]||_.default},children:[t.asset," ",t.amount]}),Object(V.jsx)("td",{className:"text-right",style:{color:_[t.asset]||_.default},children:new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(tt(t.amount,t.asset,E,t.date,K.quotes))})]},e)})):null})]})}),Object(V.jsx)(p.a,{children:K&&K.balances.length?Object(V.jsxs)(w.a,{striped:!0,bordered:!0,hover:!0,size:"sm",style:{margin:"50px 10px 10px 10px"},children:[Object(V.jsxs)("thead",{children:[Object(V.jsx)("tr",{children:Object(V.jsx)("th",{colSpan:K.assets.length+2,className:"text-right",children:"balance history"})}),Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:"date"}),K.assets.map((function(t){return Object(V.jsx)("th",{className:"text-right",children:t},t)})),Object(V.jsx)("th",{className:"text-right",children:"total"})]})]}),Object(V.jsx)("tbody",{children:K.balances.filter((function(t){return h()(t.date).isBetween(u.from,u.to)})).map((function(t){return Object(V.jsxs)("tr",{children:[Object(V.jsx)("th",{children:t.date}),K.assets.map((function(e){return Object(V.jsxs)("td",{className:"text-right",style:{color:_[e]||_.default},children:[Object(V.jsx)("span",{className:"text-muted",style:{marginRight:"1em"},children:t[e][e]}),new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(t[e][E]||0)]},"".concat(t.date,"-").concat(e))})),Object(V.jsx)("td",{className:"text-right",style:{color:_.total},children:new Intl.NumberFormat("en-GB",{style:"currency",currency:E.toUpperCase()}).format(t.total[E]||0)})]},t.date)}))})]}):null}),Object(V.jsx)(p.a,{children:Object(V.jsx)(m.a,{children:a?Object(V.jsx)(B.a,{source:a}):Object(V.jsx)(g.a,{animation:"grow"})})})]})},at=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,483)).then((function(e){var a=e.getCLS,n=e.getFID,c=e.getFCP,r=e.getLCP,s=e.getTTFB;a(t),n(t),c(t),r(t),s(t)}))};a(471);s.a.render(Object(V.jsx)(c.a.StrictMode,{children:Object(V.jsx)(et,{})}),document.getElementById("root")),at()}},[[472,1,2]]]);
//# sourceMappingURL=main.6230bee4.chunk.js.map